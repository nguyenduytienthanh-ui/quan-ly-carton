{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects\\\\app\\\\src\\\\components\\\\ExcelActions.js\";\nimport React from 'react';\nimport { FileSpreadsheet, Upload, Download } from 'lucide-react';\n\n/**\n * ExcelActions - Xuất/Nhập Excel\n * \n * Props:\n * - onExport: Callback khi xuất Excel\n * - onImport: Callback khi nhập Excel\n * - data: Dữ liệu để xuất\n * - moduleName: Tên module (để đặt tên file)\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ExcelActions({\n  onExport,\n  onImport,\n  data = [],\n  moduleName = 'data'\n}) {\n  const handleExport = () => {\n    if (!data || data.length === 0) {\n      alert('Không có dữ liệu để xuất!');\n      return;\n    }\n    try {\n      // Convert to CSV (simple Excel format)\n      const headers = Object.keys(data[0]);\n      const csvContent = [headers.join(','),\n      // Header row\n      ...data.map(row => headers.map(h => {\n        const value = row[h];\n        // Handle nested objects, arrays, special characters\n        if (typeof value === 'object' && value !== null) {\n          return `\"${JSON.stringify(value).replace(/\"/g, '\"\"')}\"`;\n        }\n        return `\"${String(value || '').replace(/\"/g, '\"\"')}\"`;\n      }).join(','))].join('\\n');\n\n      // Create download link\n      const blob = new Blob(['\\uFEFF' + csvContent], {\n        type: 'text/csv;charset=utf-8;'\n      });\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `${moduleName}_${new Date().toISOString().split('T')[0]}.csv`;\n      link.click();\n      URL.revokeObjectURL(url);\n      if (onExport) onExport(data);\n    } catch (error) {\n      console.error('Export error:', error);\n      alert('Lỗi khi xuất file! Vui lòng thử lại.');\n    }\n  };\n  const handleImportClick = () => {\n    var _document$getElementB;\n    (_document$getElementB = document.getElementById('excel-import-input')) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.click();\n  };\n  const handleFileChange = e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = event => {\n      try {\n        const text = event.target.result;\n        const lines = text.split('\\n').filter(line => line.trim());\n        if (lines.length < 2) {\n          alert('File không có dữ liệu!');\n          return;\n        }\n\n        // Parse CSV\n        const headers = lines[0].split(',').map(h => h.trim().replace(/^\"|\"$/g, ''));\n        const rows = lines.slice(1).map(line => {\n          const values = line.split(',').map(v => v.trim().replace(/^\"|\"$/g, ''));\n          const obj = {};\n          headers.forEach((h, i) => {\n            obj[h] = values[i] || '';\n          });\n          return obj;\n        });\n        if (onImport) {\n          onImport(rows);\n        }\n      } catch (error) {\n        console.error('Import error:', error);\n        alert('Lỗi khi đọc file! Vui lòng kiểm tra định dạng file.');\n      }\n    };\n    reader.readAsText(file, 'UTF-8');\n\n    // Reset input\n    e.target.value = '';\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex gap-2\",\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      id: \"excel-import-input\",\n      type: \"file\",\n      accept: \".csv,.xlsx,.xls\",\n      onChange: handleFileChange,\n      className: \"hidden\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleExport,\n      className: \"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\",\n      title: \"Xu\\u1EA5t Excel\",\n      children: [/*#__PURE__*/_jsxDEV(Download, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"hidden sm:inline\",\n        children: \"Xu\\u1EA5t Excel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleImportClick,\n      className: \"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\",\n      title: \"Nh\\u1EADp Excel\",\n      children: [/*#__PURE__*/_jsxDEV(Upload, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"hidden sm:inline\",\n        children: \"Nh\\u1EADp Excel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n_c = ExcelActions;\nexport default ExcelActions;\nvar _c;\n$RefreshReg$(_c, \"ExcelActions\");","map":{"version":3,"names":["React","FileSpreadsheet","Upload","Download","jsxDEV","_jsxDEV","ExcelActions","onExport","onImport","data","moduleName","handleExport","length","alert","headers","Object","keys","csvContent","join","map","row","h","value","JSON","stringify","replace","String","blob","Blob","type","url","URL","createObjectURL","link","document","createElement","href","download","Date","toISOString","split","click","revokeObjectURL","error","console","handleImportClick","_document$getElementB","getElementById","handleFileChange","e","_e$target$files","file","target","files","reader","FileReader","onload","event","text","result","lines","filter","line","trim","rows","slice","values","v","obj","forEach","i","readAsText","className","children","id","accept","onChange","fileName","_jsxFileName","lineNumber","columnNumber","onClick","title","_c","$RefreshReg$"],"sources":["C:/Projects/app/src/components/ExcelActions.js"],"sourcesContent":["import React from 'react';\nimport { FileSpreadsheet, Upload, Download } from 'lucide-react';\n\n/**\n * ExcelActions - Xuất/Nhập Excel\n * \n * Props:\n * - onExport: Callback khi xuất Excel\n * - onImport: Callback khi nhập Excel\n * - data: Dữ liệu để xuất\n * - moduleName: Tên module (để đặt tên file)\n */\nfunction ExcelActions({ onExport, onImport, data = [], moduleName = 'data' }) {\n  \n  const handleExport = () => {\n    if (!data || data.length === 0) {\n      alert('Không có dữ liệu để xuất!');\n      return;\n    }\n\n    try {\n      // Convert to CSV (simple Excel format)\n      const headers = Object.keys(data[0]);\n      const csvContent = [\n        headers.join(','), // Header row\n        ...data.map(row => \n          headers.map(h => {\n            const value = row[h];\n            // Handle nested objects, arrays, special characters\n            if (typeof value === 'object' && value !== null) {\n              return `\"${JSON.stringify(value).replace(/\"/g, '\"\"')}\"`;\n            }\n            return `\"${String(value || '').replace(/\"/g, '\"\"')}\"`;\n          }).join(',')\n        )\n      ].join('\\n');\n\n      // Create download link\n      const blob = new Blob(['\\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `${moduleName}_${new Date().toISOString().split('T')[0]}.csv`;\n      link.click();\n      URL.revokeObjectURL(url);\n\n      if (onExport) onExport(data);\n    } catch (error) {\n      console.error('Export error:', error);\n      alert('Lỗi khi xuất file! Vui lòng thử lại.');\n    }\n  };\n\n  const handleImportClick = () => {\n    document.getElementById('excel-import-input')?.click();\n  };\n\n  const handleFileChange = (e) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      try {\n        const text = event.target.result;\n        const lines = text.split('\\n').filter(line => line.trim());\n        \n        if (lines.length < 2) {\n          alert('File không có dữ liệu!');\n          return;\n        }\n\n        // Parse CSV\n        const headers = lines[0].split(',').map(h => h.trim().replace(/^\"|\"$/g, ''));\n        const rows = lines.slice(1).map(line => {\n          const values = line.split(',').map(v => v.trim().replace(/^\"|\"$/g, ''));\n          const obj = {};\n          headers.forEach((h, i) => {\n            obj[h] = values[i] || '';\n          });\n          return obj;\n        });\n\n        if (onImport) {\n          onImport(rows);\n        }\n      } catch (error) {\n        console.error('Import error:', error);\n        alert('Lỗi khi đọc file! Vui lòng kiểm tra định dạng file.');\n      }\n    };\n    reader.readAsText(file, 'UTF-8');\n    \n    // Reset input\n    e.target.value = '';\n  };\n\n  return (\n    <div className=\"flex gap-2\">\n      <input\n        id=\"excel-import-input\"\n        type=\"file\"\n        accept=\".csv,.xlsx,.xls\"\n        onChange={handleFileChange}\n        className=\"hidden\"\n      />\n      \n      <button\n        onClick={handleExport}\n        className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\"\n        title=\"Xuất Excel\"\n      >\n        <Download className=\"w-4 h-4\" />\n        <span className=\"hidden sm:inline\">Xuất Excel</span>\n      </button>\n\n      <button\n        onClick={handleImportClick}\n        className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n        title=\"Nhập Excel\"\n      >\n        <Upload className=\"w-4 h-4\" />\n        <span className=\"hidden sm:inline\">Nhập Excel</span>\n      </button>\n    </div>\n  );\n}\n\nexport default ExcelActions;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}